zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    - uuid: 4dd7b8eae5834d40967089882bdfa3da
      template: 'Eltex MES by SNMP export'
      name: 'Eltex MES by SNMP export'
      description: |
        https://github.com/AndAndr
        Шаблон для коммутаторов Eltex серии MES
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: 2d5b666d89c8439e9f54e29e08b665f9
          name: 'Memory Utilization Free'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.35265.41.1.2.1.1.7.0
          key: eltexProcessMemoryFree
          delay: 5m
          history: 2w
          trends: 30d
          status: DISABLED
          units: b
          description: 'The overall CPU wide system memory which is currently free in bytes.'
          tags:
            - tag: component
              value: system
        - uuid: e291a9de39f142d69cbe42c648096e01
          name: 'Memory Utilization Free Percent'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.35265.41.1.2.1.1.6.0
          key: eltexProcessMemoryFreePercent
          delay: 5m
          history: 2w
          trends: 30d
          units: '%'
          description: 'The overall CPU wide system memory which is currently free in percents.'
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: e319f505ccc44cfe9e42dd3b0edb2646
              expression: 'last(/Eltex MES by SNMP export/eltexProcessMemoryFreePercent)>{$MEM.MAX.USAGE}'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'last(/Eltex MES by SNMP export/eltexProcessMemoryFreePercent)<{$MEM.MAX.USAGE}-5'
              name: 'High memory usage'
              opdata: 'Memory Usage: {ITEM.LASTVALUE1}'
              priority: WARNING
              tags:
                - tag: scope
                  value: capacity
                - tag: scope
                  value: performance
        - uuid: 6863910fe69a48fd92ac6cca11b9da81
          name: 'Memory Total'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.35265.41.1.2.1.1.3.0
          key: eltexProcessMemoryTotal
          delay: 5m
          history: 2w
          trends: 30d
          status: DISABLED
          units: b
          description: 'The overall CPU wide system memory size which is currently in system.'
          tags:
            - tag: component
              value: system
        - uuid: 69647f23cfdd4e87bd40099a972842cb
          name: 'ICMP ping'
          type: SIMPLE
          key: icmpping
          history: 1w
          tags:
            - tag: component
              value: network
          triggers:
            - uuid: b254062c9e1b4e4fa37864d2009ac7da
              expression: 'last(/Eltex MES by SNMP export/icmpping,#3)=0'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'last(/Eltex MES by SNMP export/icmpping,#3)=1'
              name: 'Тест доступности по протоколу ICMP'
              priority: HIGH
              description: |
                Last value: {ITEM.LASTVALUE1}.
                Last three attempts returned timeout.  Please check device connectivity.
              tags:
                - tag: scope
                  value: availability
        - uuid: e770f74c24444910a9d4463f1c2f2cd5
          name: 'ICMP loss'
          type: SIMPLE
          key: icmppingloss
          history: 1w
          value_type: FLOAT
          units: '%'
          tags:
            - tag: component
              value: network
          triggers:
            - uuid: a8862532c59b467f8fc5f4568e62797d
              expression: 'min(/Eltex MES by SNMP export/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Eltex MES by SNMP export/icmppingloss,5m)<100'
              name: 'High ICMP ping loss'
              priority: WARNING
              dependencies:
                - name: 'Тест доступности по протоколу ICMP'
                  expression: 'last(/Eltex MES by SNMP export/icmpping,#3)=0'
                  recovery_expression: 'last(/Eltex MES by SNMP export/icmpping,#3)=1'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: db97b4e8e7c2441c9ca7146617c56c51
          name: 'ICMP response time'
          type: SIMPLE
          key: icmppingsec
          history: 1w
          value_type: FLOAT
          units: s
          tags:
            - tag: component
              value: network
          triggers:
            - uuid: a6bb3aad5ba94a6d8afa62f41e8e5dd4
              expression: 'avg(/Eltex MES by SNMP export/icmppingsec,5m)>{$ICMP_RESPONSE_TIME_WARN}'
              name: 'High ICMP ping response time'
              priority: WARNING
              dependencies:
                - name: 'High ICMP ping loss'
                  expression: 'min(/Eltex MES by SNMP export/icmppingloss,5m)>{$ICMP_LOSS_WARN} and min(/Eltex MES by SNMP export/icmppingloss,5m)<100'
                - name: 'Тест доступности по протоколу ICMP'
                  expression: 'last(/Eltex MES by SNMP export/icmpping,#3)=0'
                  recovery_expression: 'last(/Eltex MES by SNMP export/icmpping,#3)=1'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: e588744d759a49c4a029bc538a68549c
          name: 'CPU Utilization 1min'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.4.1.89.1.8.0
          key: rlCpuUtilDuringLastMinute
          delay: 3m
          history: 14d
          trends: 60d
          units: '%'
          description: 'Percentage of the device CPU utilization during last minute. The value 101 is a dummy value, indicating that the CPU utilization was not measured (since measurement is disabled or was disabled during last minute).'
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 8d389bd2983e4f99ad2a691272bea9ec
              expression: 'last(/Eltex MES by SNMP export/rlCpuUtilDuringLastMinute)>{$CPU.MAX.USAGE} and last(/Eltex MES by SNMP export/rlCpuUtilDuringLastMinute)<=100'
              name: 'High CPU usage'
              opdata: 'CPU Usage: {ITEM.LASTVALUE1}'
              priority: WARNING
              tags:
                - tag: scope
                  value: performance
        - uuid: c5970276cc954dca899197d3a307832c
          name: 'SNMP traps (fallback)'
          type: SNMP_TRAP
          key: snmptrap.fallback
          delay: '0'
          value_type: LOG
          trends: '0'
          description: 'The item is used to collect all SNMP traps unmatched by other snmptrap items'
          logtimefmt: 'hh:mm:sszyyyy/MM/dd'
          tags:
            - tag: component
              value: network
        - uuid: 19199287284040748bdc8c0aee3770a0
          name: 'System contact details'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.4.0
          key: 'system.contact[sysContact.0]'
          delay: 1h
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            The textual identification of the contact person for this managed node, together with information on how to contact this person.  If no contact information is known, the value is the zero-length string.
          inventory_link: CONTACT
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 6498218fac474d93a7f54676408a5928
          name: 'System description'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: 'system.descr[sysDescr.0]'
          delay: 1h
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            A textual description of the entity. This value should
            include the full name and version identification of the system's hardware type, software operating-system, and
            networking software.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 91a078f482694447b4b70d51489164c6
          name: 'System location'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.6.0
          key: 'system.location[sysLocation.0]'
          delay: 1h
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            Physical location of the node (e.g., `equipment room`, `3rd floor`). If not provided, the value is a zero-length string.
          inventory_link: LOCATION
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: 8fb7a863702f4140a3e0bcd45bdcacaf
          name: 'System name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.5.0
          key: system.name
          delay: 1h
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            An administratively-assigned name for this managed node.By convention, this is the node's fully-qualified domain name.  If the name is unknown, the value is the zero-length string.
          inventory_link: NAME
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          tags:
            - tag: component
              value: system
          triggers:
            - uuid: 4a478a6bd24247cc8e3bc3740cf1d0fa
              expression: 'last(/Eltex MES by SNMP export/system.name,#1)<>last(/Eltex MES by SNMP export/system.name,#2) and length(last(/Eltex MES by SNMP export/system.name))>0'
              name: 'System name has changed'
              event_name: 'System name has changed (new name: {ITEM.VALUE})'
              priority: INFO
              description: 'The name of the system has changed. Acknowledge to close the problem manually.'
              manual_close: 'YES'
              tags:
                - tag: scope
                  value: notice
                - tag: scope
                  value: security
        - uuid: 59e611367ce14360a48a758f5f70cef3
          name: Uptime
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.3.0
          key: 'system.net.uptime[sysUpTime.0]'
          trends: '0'
          units: uptime
          description: |
            MIB: SNMPv2-MIB
            Time (in hundredths of a second) since the network management portion of the system was last re-initialized.
          preprocessing:
            - type: MULTIPLIER
              parameters:
                - '0.01'
          tags:
            - tag: component
              value: system
        - uuid: 810c7c3d57a44a3fa1b5f5ecdde3f50c
          name: 'System object ID'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.2.0
          key: 'system.objectid[sysObjectID.0]'
          delay: 1h
          value_type: CHAR
          trends: '0'
          description: |
            MIB: SNMPv2-MIB
            The vendor's authoritative identification of the network management subsystem contained in the entity.  This value is allocated within the SMI enterprises subtree (1.3.6.1.4.1) and provides an easy and unambiguous means for determining`what kind of box' is being managed.  For example, if vendor`Flintstones, Inc.' was assigned the subtree1.3.6.1.4.1.4242, it could assign the identifier 1.3.6.1.4.1.4242.1.1 to its `Fred Router'.
          preprocessing:
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 12h
          tags:
            - tag: component
              value: system
        - uuid: cb2dd052a85b4d9db091dbf9c8018aff
          name: 'SNMP agent availability'
          type: INTERNAL
          key: 'zabbix[host,snmp,available]'
          delay: 5m
          description: |
            Availability of SNMP checks on the host. The value of this item corresponds to availability icons in the host list.
            Possible values:
            0 - not available
            1 - available
            2 - unknown
          tags:
            - tag: component
              value: health
            - tag: component
              value: network
          triggers:
            - uuid: c7a70a55d9dc468f947790f7f70fce76
              expression: 'max(/Eltex MES by SNMP export/zabbix[host,snmp,available],{$SNMP.TIMEOUT})=0'
              name: 'No SNMP data collection'
              opdata: 'Current state: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'SNMP is not available for polling. Please check device connectivity and SNMP settings.'
              tags:
                - tag: scope
                  value: availability
      discovery_rules:
        - uuid: 0529f79a32cd41a4849815e727e073f3
          name: 'Copper network interfaces discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#MEDIATYPE},1.3.6.1.4.1.89.53.3.1.3]'
          key: copper.net.if.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.MATCHES}'
                formulaid: A
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.MATCHES}'
                formulaid: C
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
                formulaid: E
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: F
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.MATCHES}'
                formulaid: G
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: H
              - macro: '{#MEDIATYPE}'
                value: '^.*$'
                formulaid: I
              - macro: '{#MEDIATYPE}'
                value: '^[2-3]$'
                operator: NOT_MATCHES_REGEX
                formulaid: J
          lifetime: 3d
          description: 'Discovering copper interfaces.'
          item_prototypes:
            - uuid: d07a49dedd4b4d489afa7148da97cce3
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}'
              key: 'net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
              delay: 3m
              description: |
                MIB: IF-MIB
                The number of inbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: ed38cea59eeb4d9196ee9ffc53628c82
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
              key: 'net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
              delay: 3m
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: f66e0cb0877e497f802b4c9bbfb35182
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits received'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}'
              key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface, including framing characters. This object is a 64-bit version of ifInOctets. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 2f70dfff3a114645b3f7598b116791c3
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}'
              key: 'net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
              delay: 3m
              description: |
                MIB: IF-MIB
                The number of outbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: fa1957d2618f4a76bd4c8b035c592e6d
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
              key: 'net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
              delay: 3m
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 24b05fb5c45b49e0a1181a24b751278d
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}'
              key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. This object is a 64-bit version of ifOutOctets.Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 7d44477dc80841d49994b0a8d0736666
              name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}'
              key: 'net.if.speed[ifHighSpeed.{#SNMPINDEX}]'
              delay: 5m
              trends: '0'
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in units of 1,000,000 bits per second. If this object reports a value of `n' then the speed of the interface is somewhere in the range of `n-500,000' to`n+499,999'.  For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth. For a sub-layer which has no concept of bandwidth, this object should be zero.
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 9ee61174109d458e8c723b4f05bdb233
              name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
              key: 'net.if.status[ifOperStatus.{#SNMPINDEX}]'
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              valuemap:
                name: 'IF-MIB::ifOperStatus'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: 455c8330fb15496e85d065c3bce46cf1
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Eltex MES by SNMP export/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Eltex MES by SNMP export/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Eltex MES by SNMP export/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Eltex MES by SNMP export/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2'
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: |
                    Триггер работает следующим образом:
                    1. Стреляет, если "Operation status" интерфейса уходит в состояние "Down(0)".
                    2. Вы можете определять на уровне шаблона или создать на хосте макрос { $IFCONTROL }=1 - для глобального определения всех интерфейсов важными или { $IFCONTROL }=0 - не важными. (Убрать пробелы!)
                    3. Вы можете использовать на хосте макросы с контекстом для определения конкретного интерфейса важным или не важным, в зависимости от Вашего решения в п.2, например:
                    { $IFCONTROL:{#IFNAME} }=1. (Убрать пробелы!)
                    4. Стреляет, если "Operation status" интерфейса до этого был в состоянии "Up(1)"
                    5. Триггер можно закрыть вручную, стрелять при следующем опросе он не будет потому, что п.4.
                  tags:
                    - tag: scope
                      value: availability
          trigger_prototypes:
            - uuid: a76012b5040143d8b21492330d43652b
              expression: |
                (avg(/Eltex MES by SNMP export/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Eltex MES by SNMP export/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or
                avg(/Eltex MES by SNMP export/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Eltex MES by SNMP export/net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and
                last(/Eltex MES by SNMP export/net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/Eltex MES by SNMP export/net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Eltex MES by SNMP export/net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and
                avg(/Eltex MES by SNMP export/net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Eltex MES by SNMP export/net.if.speed[ifHighSpeed.{#SNMPINDEX}])
              name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage ( > {$IF.UTIL.MAX:"{#IFNAME}"}% )'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: INFO
              dependencies:
                - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Eltex MES by SNMP export/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Eltex MES by SNMP export/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Eltex MES by SNMP export/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_expression: 'last(/Eltex MES by SNMP export/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2'
              tags:
                - tag: scope
                  value: notice
            - uuid: a4dc233194a04217a0bf6ac5197eebc3
              expression: |
                min(/Eltex MES by SNMP export/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/Eltex MES by SNMP export/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/Eltex MES by SNMP export/net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/Eltex MES by SNMP export/net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Interface {#IFNAME}({#IFALIAS}): High error rate ( > {$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'Recovers when below 80% of {$IF.ERRORS.WARN:"{#IFNAME}"} threshold'
              dependencies:
                - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Eltex MES by SNMP export/net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Eltex MES by SNMP export/net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Eltex MES by SNMP export/net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_expression: 'last(/Eltex MES by SNMP export/net.if.status[ifOperStatus.{#SNMPINDEX}])<>2'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: 6ef855def0d84053b11b4627914375f6
          name: 'LAG network interfaces discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]'
          key: lag.net.if.discovery
          delay: 1h
          filter:
            conditions:
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.MATCHES}'
                formulaid: A
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.MATCHES}'
                formulaid: C
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
                formulaid: E
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: F
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.MATCHES}'
                formulaid: G
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: H
              - macro: '{#IFTYPE}'
                value: ^161$
                formulaid: I
          lifetime: 3d
          description: 'Discovering LAG interfaces.'
          item_prototypes:
            - uuid: 6a91310766a849b79fe92f2e76b8fdaa
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits received'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}'
              key: 'lag.net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface, including framing characters. This object is a 64-bit version of ifInOctets. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: d79f6ae85fd1484ebfa2deec1cc28aba
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}'
              key: 'lag.net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. This object is a 64-bit version of ifOutOctets.Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: c2401748eb794e6d8455916014d21c4e
              name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}'
              key: 'lag.net.if.speed[ifHighSpeed.{#SNMPINDEX}]'
              delay: 3m
              trends: '0'
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in units of 1,000,000 bits per second. If this object reports a value of `n' then the speed of the interface is somewhere in the range of `n-500,000' to`n+499,999'.  For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth. For a sub-layer which has no concept of bandwidth, this object should be zero.
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: b600c05db32c4f78ade09a688eeddadc
              name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
              key: 'lag.net.if.status[ifOperStatus.{#SNMPINDEX}]'
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              valuemap:
                name: 'IF-MIB::ifOperStatus'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: 375b15e6bb4d4fddbfdc446e72e5c2e1
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Eltex MES by SNMP export/lag.net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Eltex MES by SNMP export/lag.net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Eltex MES by SNMP export/lag.net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Eltex MES by SNMP export/lag.net.if.status[ifOperStatus.{#SNMPINDEX}])<>2'
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: |
                    Триггер работает следующим образом:
                    1. Стреляет, если "Operation status" интерфейса уходит в состояние "Down(0)".
                    2. Вы можете определять на уровне шаблона или создать на хосте макрос { $IFCONTROL }=1 - для глобального определения всех интерфейсов важными или { $IFCONTROL }=0 - не важными. (Убрать пробелы!)
                    3. Вы можете использовать на хосте макросы с контекстом для определения конкретного интерфейса важным или не важным, в зависимости от Вашего решения в п.2, например:
                    { $IFCONTROL:{#IFNAME} }=1. (Убрать пробелы!)
                    4. Стреляет, если "Operation status" интерфейса до этого был в состоянии "Up(1)"
                    5. Триггер можно закрыть вручную, стрелять при следующем опросе он не будет потому, что п.4.
                  tags:
                    - tag: scope
                      value: availability
          trigger_prototypes:
            - uuid: 53a729d5bc514c6c96a00e5d0f5c92d5
              expression: |
                (avg(/Eltex MES by SNMP export/lag.net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Eltex MES by SNMP export/lag.net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or
                avg(/Eltex MES by SNMP export/lag.net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Eltex MES by SNMP export/lag.net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and
                last(/Eltex MES by SNMP export/lag.net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/Eltex MES by SNMP export/lag.net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Eltex MES by SNMP export/lag.net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and
                avg(/Eltex MES by SNMP export/lag.net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Eltex MES by SNMP export/lag.net.if.speed[ifHighSpeed.{#SNMPINDEX}])
              name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage ( > {$IF.UTIL.MAX:"{#IFNAME}"}% )'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: INFO
              description: 'The network interface utilization is close to its estimated maximum bandwidth.'
              dependencies:
                - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Eltex MES by SNMP export/lag.net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Eltex MES by SNMP export/lag.net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Eltex MES by SNMP export/lag.net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_expression: 'last(/Eltex MES by SNMP export/lag.net.if.status[ifOperStatus.{#SNMPINDEX}])<>2'
              tags:
                - tag: scope
                  value: notice
        - uuid: 05a7a495e83e441d8b71cf9cfc05e9ca
          name: 'Optic network interfaces discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1,{#IFDESCR},1.3.6.1.2.1.2.2.1.2,{#MEDIATYPE},1.3.6.1.4.1.89.53.3.1.3]'
          key: optic.net.if.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.MATCHES}'
                formulaid: A
              - macro: '{#IFADMINSTATUS}'
                value: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: B
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.MATCHES}'
                formulaid: C
              - macro: '{#IFALIAS}'
                value: '{$NET.IF.IFALIAS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: D
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.MATCHES}'
                formulaid: E
              - macro: '{#IFNAME}'
                value: '{$NET.IF.IFNAME.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: F
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.MATCHES}'
                formulaid: G
              - macro: '{#IFOPERSTATUS}'
                value: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
                operator: NOT_MATCHES_REGEX
                formulaid: H
              - macro: '{#MEDIATYPE}'
                value: '^.*$'
                formulaid: I
              - macro: '{#MEDIATYPE}'
                value: ^1$
                operator: NOT_MATCHES_REGEX
                formulaid: J
          lifetime: 3d
          description: 'Discovering copper interfaces (optic-fiber(2) or combo(3))'
          item_prototypes:
            - uuid: 96d6dcbb550c478199ccc2d77264e550
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.13.{#SNMPINDEX}'
              key: 'optic.net.if.in.discards[ifInDiscards.{#SNMPINDEX}]'
              delay: 3m
              description: |
                MIB: IF-MIB
                The number of inbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 2c81de65210d4d6eaed106f471118426
              name: 'Interface {#IFNAME}({#IFALIAS}): Inbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.14.{#SNMPINDEX}'
              key: 'optic.net.if.in.errors[ifInErrors.{#SNMPINDEX}]'
              delay: 3m
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of inbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of inbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 609c910f70734684a39244b3a5a8538f
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits received'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}'
              key: 'optic.net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets received on the interface, including framing characters. This object is a 64-bit version of ifInOctets. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: e67fa8428c0e4b7fb5a7df1c298ee3ca
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets discarded'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.19.{#SNMPINDEX}'
              key: 'optic.net.if.out.discards[ifOutDiscards.{#SNMPINDEX}]'
              delay: 3m
              description: |
                MIB: IF-MIB
                The number of Outbound packets which were chosen to be discarded
                even though no errors had been detected to prevent their being deliverable to a higher-layer protocol.
                One possible reason for discarding such a packet could be to free up buffer space.
                Discontinuities in the value of this counter can occur at re-initialization of the management system,
                and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 0e5b161346fe441ab995576487145425
              name: 'Interface {#IFNAME}({#IFALIAS}): Outbound packets with errors'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.20.{#SNMPINDEX}'
              key: 'optic.net.if.out.errors[ifOutErrors.{#SNMPINDEX}]'
              delay: 3m
              description: |
                MIB: IF-MIB
                For packet-oriented interfaces, the number of outbound packets that contained errors preventing them from being deliverable to a higher-layer protocol.  For character-oriented or fixed-length interfaces, the number of outbound transmission units that contained errors preventing them from being deliverable to a higher-layer protocol. Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 566d95741dac4710b56ec075b20f052e
              name: 'Interface {#IFNAME}({#IFALIAS}): Bits sent'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}'
              key: 'optic.net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              units: bps
              description: |
                MIB: IF-MIB
                The total number of octets transmitted out of the interface, including framing characters. This object is a 64-bit version of ifOutOctets.Discontinuities in the value of this counter can occur at re-initialization of the management system, and at other times as indicated by the value of ifCounterDiscontinuityTime.
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                - type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 5615970c3d9f4e2e95398625b03d46fc
              name: 'Interface {#IFNAME}({#IFALIAS}): Speed'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.15.{#SNMPINDEX}'
              key: 'optic.net.if.speed[ifHighSpeed.{#SNMPINDEX}]'
              delay: 3m
              trends: '0'
              units: bps
              description: |
                MIB: IF-MIB
                An estimate of the interface's current bandwidth in units of 1,000,000 bits per second. If this object reports a value of `n' then the speed of the interface is somewhere in the range of `n-500,000' to`n+499,999'.  For interfaces which do not vary in bandwidth or for those where no accurate estimation can be made, this object should contain the nominal bandwidth. For a sub-layer which has no concept of bandwidth, this object should be zero.
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 10e7cb223e2e4ff5b86d43f9734ca4d3
              name: 'Interface {#IFNAME}({#IFALIAS}): Operational status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.8.{#SNMPINDEX}'
              key: 'optic.net.if.status[ifOperStatus.{#SNMPINDEX}]'
              trends: '0'
              description: |
                MIB: IF-MIB
                The current operational state of the interface.
                - The testing(3) state indicates that no operational packet scan be passed
                - If ifAdminStatus is down(2) then ifOperStatus should be down(2)
                - If ifAdminStatus is changed to up(1) then ifOperStatus should change to up(1) if the interface is ready to transmit and receive network traffic
                - It should change todormant(5) if the interface is waiting for external actions (such as a serial line waiting for an incoming connection)
                - It should remain in the down(2) state if and only if there is a fault that prevents it from going to the up(1) state
                - It should remain in the notPresent(6) state if the interface has missing(typically, hardware) components.
              valuemap:
                name: 'IF-MIB::ifOperStatus'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: 105da5f52f544df6bf86060fd84d8a8e
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Eltex MES by SNMP export/optic.net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Eltex MES by SNMP export/optic.net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Eltex MES by SNMP export/optic.net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Eltex MES by SNMP export/optic.net.if.status[ifOperStatus.{#SNMPINDEX}])<>2'
                  name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: |
                    Триггер работает следующим образом:
                    1. Стреляет, если "Operation status" интерфейса уходит в состояние "Down(0)".
                    2. Вы можете определять на уровне шаблона или создать на хосте макрос { $IFCONTROL }=1 - для глобального определения всех интерфейсов важными или { $IFCONTROL }=0 - не важными. (Убрать пробелы!)
                    3. Вы можете использовать на хосте макросы с контекстом для определения конкретного интерфейса важным или не важным, в зависимости от Вашего решения в п.2, например:
                    { $IFCONTROL:{#IFNAME} }=1. (Убрать пробелы!)
                    4. Стреляет, если "Operation status" интерфейса до этого был в состоянии "Up(1)"
                    5. Триггер можно закрыть вручную, стрелять при следующем опросе он не будет потому, что п.4.
                  tags:
                    - tag: scope
                      value: availability
            - uuid: b717f6bb68974c2ba2bb9d31151080cf
              name: 'Interface {#IFNAME}({#IFALIAS}): SFP Input power'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.89.90.1.2.1.3.{#SNMPINDEX}.9'
              key: 'optic.rlPhyTestGetResult.InPow[{#SNMPINDEX}]'
              delay: 10m
              value_type: FLOAT
              units: mW/dBm
              description: 'Input power on SFP interface.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.001'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: 3acafb7a818341849454453e4c9a505a
              name: 'Interface {#IFNAME}({#IFALIAS}): SFP mA'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.89.90.1.2.1.3.{#SNMPINDEX}.7'
              key: 'optic.rlPhyTestGetResult.mA[{#SNMPINDEX}]'
              delay: 10m
              value_type: FLOAT
              units: mA
              description: 'mA on SFP interface.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.001'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: b677ab026a1f49a9a59e07d82e14f55f
              name: 'Interface {#IFNAME}({#IFALIAS}): SFP Out power'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.89.90.1.2.1.3.{#SNMPINDEX}.8'
              key: 'optic.rlPhyTestGetResult.OutPow[{#SNMPINDEX}]'
              delay: 10m
              value_type: FLOAT
              units: mW/dBm
              description: 'Out power on SFP interface.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '0.001'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
            - uuid: d9c4bf664c1a4af99515ba1a8fd349f4
              name: 'Interface {#IFNAME}({#IFALIAS}): SFP temperature'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.89.90.1.2.1.3.{#SNMPINDEX}.5'
              key: 'optic.rlPhyTestGetResult.t[{#SNMPINDEX}]'
              delay: 10m
              value_type: FLOAT
              units: '`C'
              description: 'Temperature on SFP interface.'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
              trigger_prototypes:
                - uuid: 96b1f71ff9674336b96b07c5264e00b7
                  expression: 'last(/Eltex MES by SNMP export/optic.rlPhyTestGetResult.t[{#SNMPINDEX}])>{$SFP.MAX.TEMPERATURE}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Eltex MES by SNMP export/optic.rlPhyTestGetResult.t[{#SNMPINDEX}])<{$SFP.MAX.TEMPERATURE}-2'
                  name: 'Interface {#IFNAME}({#IFALIAS}): Температура SFP больше {$SFP.MAX.TEMPERATURE}'
                  opdata: 'SFP t` = {ITEM.LASTVALUE1}'
                  priority: WARNING
                  tags:
                    - tag: scope
                      value: availability
                    - tag: scope
                      value: performance
            - uuid: 60e3309cac814645a4c9c7d37a756613
              name: 'Interface {#IFNAME}({#IFALIAS}): SFP Volt'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.89.90.1.2.1.3.{#SNMPINDEX}.6'
              key: 'optic.rlPhyTestGetResult.v[{#SNMPINDEX}]'
              delay: 10m
              value_type: FLOAT
              units: V
              description: 'Volt on SFP interface.'
              preprocessing:
                - type: MULTIPLIER
                  parameters:
                    - '1.0E-6'
              tags:
                - tag: component
                  value: network
                - tag: description
                  value: '{#IFALIAS}'
                - tag: interface
                  value: '{#IFNAME}'
          trigger_prototypes:
            - uuid: 9afcca38f02847afa99a8c388d18439e
              expression: |
                (avg(/Eltex MES by SNMP export/optic.net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Eltex MES by SNMP export/optic.net.if.speed[ifHighSpeed.{#SNMPINDEX}]) or
                avg(/Eltex MES by SNMP export/optic.net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)>({$IF.UTIL.MAX:"{#IFNAME}"}/100)*last(/Eltex MES by SNMP export/optic.net.if.speed[ifHighSpeed.{#SNMPINDEX}])) and
                last(/Eltex MES by SNMP export/optic.net.if.speed[ifHighSpeed.{#SNMPINDEX}])>0
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                avg(/Eltex MES by SNMP export/optic.net.if.in[ifHCInOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Eltex MES by SNMP export/optic.net.if.speed[ifHighSpeed.{#SNMPINDEX}]) and
                avg(/Eltex MES by SNMP export/optic.net.if.out[ifHCOutOctets.{#SNMPINDEX}],15m)<(({$IF.UTIL.MAX:"{#IFNAME}"}-3)/100)*last(/Eltex MES by SNMP export/optic.net.if.speed[ifHighSpeed.{#SNMPINDEX}])
              name: 'Interface {#IFNAME}({#IFALIAS}): High bandwidth usage ( > {$IF.UTIL.MAX:"{#IFNAME}"}% )'
              opdata: 'In: {ITEM.LASTVALUE1}, out: {ITEM.LASTVALUE3}, speed: {ITEM.LASTVALUE2}'
              priority: INFO
              description: 'The network interface utilization is close to its estimated maximum bandwidth.'
              dependencies:
                - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Eltex MES by SNMP export/optic.net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Eltex MES by SNMP export/optic.net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Eltex MES by SNMP export/optic.net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_expression: 'last(/Eltex MES by SNMP export/optic.net.if.status[ifOperStatus.{#SNMPINDEX}])<>2'
              tags:
                - tag: scope
                  value: notice
            - uuid: ef47ae122203481dbcddce05b1f876bb
              expression: |
                min(/Eltex MES by SNMP export/optic.net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
                or min(/Eltex MES by SNMP export/optic.net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)>{$IF.ERRORS.WARN:"{#IFNAME}"}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: |
                max(/Eltex MES by SNMP export/optic.net.if.in.errors[ifInErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
                and max(/Eltex MES by SNMP export/optic.net.if.out.errors[ifOutErrors.{#SNMPINDEX}],5m)<{$IF.ERRORS.WARN:"{#IFNAME}"}*0.8
              name: 'Interface {#IFNAME}({#IFALIAS}): High error rate ( > {$IF.ERRORS.WARN:"{#IFNAME}"} for 5m)'
              opdata: 'errors in: {ITEM.LASTVALUE1}, errors out: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: 'Recovers when below 80% of {$IF.ERRORS.WARN:"{#IFNAME}"} threshold'
              dependencies:
                - name: 'Interface {#IFNAME}({#IFALIAS}): Link down'
                  expression: '{$IFCONTROL:"{#IFNAME}"}=1 and (last(/Eltex MES by SNMP export/optic.net.if.status[ifOperStatus.{#SNMPINDEX}])=2 and (last(/Eltex MES by SNMP export/optic.net.if.status[ifOperStatus.{#SNMPINDEX}],#1)<>last(/Eltex MES by SNMP export/optic.net.if.status[ifOperStatus.{#SNMPINDEX}],#2))=1)'
                  recovery_expression: 'last(/Eltex MES by SNMP export/optic.net.if.status[ifOperStatus.{#SNMPINDEX}])<>2'
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
            - uuid: 8e7350e5a5ab4567a75b2db6b1d4eced
              expression: 'avg(/Eltex MES by SNMP export/optic.rlPhyTestGetResult.InPow[{#SNMPINDEX}],5m)<(avg(/Eltex MES by SNMP export/optic.rlPhyTestGetResult.OutPow[{#SNMPINDEX}],5m)*{$SFP.INOUTPOW.RATIO})'
              name: 'Interface {#IFNAME}({#IFALIAS}): Затухание на SFP'
              opdata: 'InPow: {ITEM.LASTVALUE1}, OutPow: {ITEM.LASTVALUE2}'
              priority: WARNING
              description: |
                Потери мощности на оптической линии.
                Для корректировки чувствительности смотри макрос 
                { $SFP.INOUTPOW.RATIO }
              tags:
                - tag: scope
                  value: availability
                - tag: scope
                  value: performance
        - uuid: 74498c3143384d3aab4b160e1dbaf9c9
          name: 'Eltex chassis discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},.1.3.6.1.4.1.89.53.15.1.1]'
          key: StackUnit
          delay: 1h
          lifetime: 1w
          item_prototypes:
            - uuid: d30200e0976e4d77bd5d8df76f1d4fc2
              name: 'StackUnit-{#SNMPVALUE} ProductID'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.4.1.6.{#SNMPVALUE}'
              key: 'rlPhdStackProductID.[{#SNMPVALUE}]'
              delay: 1h
              history: 14d
              value_type: CHAR
              trends: '0'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: component
                  value: system
            - uuid: 23c6de4184f7411e804e124d77b64784
              name: 'StackUnit-{#SNMPVALUE} Fan1 status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.15.1.4.{#SNMPVALUE}'
              key: 'rlPhdUnitEnvParamFan1Status[{#SNMPVALUE}]'
              history: 14d
              trends: 60d
              valuemap:
                name: RlEnvMonState
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: component
                  value: fan
              trigger_prototypes:
                - uuid: 782393dfb6684cda8add1cd3b7aabd44
                  expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan1Status[{#SNMPVALUE}])<>1 and (last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan1Status[{#SNMPVALUE}],#1)<>last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan1Status[{#SNMPVALUE}],#2))=1'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan1Status[{#SNMPVALUE}])=1'
                  name: 'Fan1 status is not OK on {HOST.NAME} StackUnit-{#SNMPVALUE}'
                  priority: WARNING
                  tags:
                    - tag: scope
                      value: availability
            - uuid: e0615b8dc81143b4bf391052c5910bf7
              name: 'StackUnit-{#SNMPVALUE} Fan2 status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.15.1.5.{#SNMPVALUE}'
              key: 'rlPhdUnitEnvParamFan2Status[{#SNMPVALUE}]'
              history: 14d
              trends: 60d
              valuemap:
                name: RlEnvMonState
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: component
                  value: fan
              trigger_prototypes:
                - uuid: f382b8efea5f47c39c73d8013be8a60e
                  expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan2Status[{#SNMPVALUE}])<>1 and (last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan2Status[{#SNMPVALUE}],#1)<>last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan2Status[{#SNMPVALUE}],#2))=1'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan2Status[{#SNMPVALUE}])=1'
                  name: 'Fan2 status is not OK on {HOST.NAME} StackUnit-{#SNMPVALUE}'
                  priority: WARNING
                  tags:
                    - tag: scope
                      value: availability
            - uuid: a7b19e935c554b328d9ca8326ce1b753
              name: 'StackUnit-{#SNMPVALUE} Fan3 status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.15.1.6.{#SNMPVALUE}'
              key: 'rlPhdUnitEnvParamFan3Status[{#SNMPVALUE}]'
              history: 14d
              trends: 60d
              valuemap:
                name: RlEnvMonState
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: component
                  value: fan
              trigger_prototypes:
                - uuid: 654cacbf249042eeafe85d57880368da
                  expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan3Status[{#SNMPVALUE}])<>1 and (last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan3Status[{#SNMPVALUE}],#1)<>last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan3Status[{#SNMPVALUE}],#2))=1'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan3Status[{#SNMPVALUE}])=1'
                  name: 'Fan3 status is not OK on {HOST.NAME} StackUnit-{#SNMPVALUE}'
                  priority: WARNING
                  tags:
                    - tag: scope
                      value: availability
            - uuid: c5738c414a68413596a22c77eeba52b8
              name: 'StackUnit-{#SNMPVALUE} Fan4 status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.15.1.7.{#SNMPVALUE}'
              key: 'rlPhdUnitEnvParamFan4Status[{#SNMPVALUE}]'
              history: 14d
              trends: 60d
              valuemap:
                name: RlEnvMonState
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: component
                  value: fan
              trigger_prototypes:
                - uuid: d823aee3c630493c925205c81dcab451
                  expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan4Status[{#SNMPVALUE}])<>1 and (last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan4Status[{#SNMPVALUE}],#1)<>last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan4Status[{#SNMPVALUE}],#2))=1'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan4Status[{#SNMPVALUE}])=1'
                  name: 'Fan4 status is not OK on {HOST.NAME} StackUnit-{#SNMPVALUE}'
                  priority: WARNING
                  tags:
                    - tag: scope
                      value: availability
            - uuid: c9378e40d38d46a2a0ab64378e5de738
              name: 'StackUnit-{#SNMPVALUE} Fan5 status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.15.1.8.{#SNMPVALUE}'
              key: 'rlPhdUnitEnvParamFan5Status[{#SNMPVALUE}]'
              history: 14d
              trends: 60d
              valuemap:
                name: RlEnvMonState
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: component
                  value: fan
            - uuid: b6c4910290cb46bfae3bb7e680a429a3
              name: 'StackUnit-{#SNMPVALUE} Fan6 status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.15.1.9.{#SNMPVALUE}'
              key: 'rlPhdUnitEnvParamFan6Status[{#SNMPVALUE}]'
              history: 14d
              trends: 60d
              valuemap:
                name: RlEnvMonState
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: component
                  value: fan
              trigger_prototypes:
                - uuid: 4c21c00b631a4b12a4641b6fca0f7cad
                  expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan6Status[{#SNMPVALUE}])<>1 and (last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan6Status[{#SNMPVALUE}],#1)<>last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan6Status[{#SNMPVALUE}],#2))=1'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamFan6Status[{#SNMPVALUE}])=1'
                  name: 'Fan6 status is not OK on {HOST.NAME} StackUnit-{#SNMPVALUE}'
                  priority: WARNING
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 802f48bb31754a59947cf6ff9e71fbda
              name: 'StackUnit-{#SNMPVALUE} Main PS Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.15.1.2.{#SNMPVALUE}'
              key: 'rlPhdUnitEnvParamMainPSStatus[{#SNMPVALUE}]'
              history: 14d
              trends: 60d
              valuemap:
                name: RlEnvMonState
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: component
                  value: power
              trigger_prototypes:
                - uuid: 5beb4553f7014730b3cfe7757b3cb99f
                  expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamMainPSStatus[{#SNMPVALUE}])<>1'
                  name: 'Main power supply is not OK on {HOST.NAME} StackUnit-{#SNMPVALUE}'
                  priority: WARNING
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 318e2e088def4ad4998d95b2df007970
              name: 'StackUnit-{#SNMPVALUE} Redundant PS Status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.15.1.3.{#SNMPVALUE}'
              key: 'rlPhdUnitEnvParamRedundantPSStatus[{#SNMPVALUE}]'
              history: 14d
              trends: 60d
              valuemap:
                name: RlEnvMonState
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: component
                  value: power
              trigger_prototypes:
                - uuid: 82a55b622f404cd5aabe938e99456aa2
                  expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamRedundantPSStatus[{#SNMPVALUE}])<>1 and last(/Eltex MES by SNMP export/rlPhdUnitEnvParamRedundantPSStatus[{#SNMPVALUE}])<>5'
                  name: 'Redundant power supply is not OK on {HOST.NAME} StackUnit-{#SNMPVALUE}'
                  priority: WARNING
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 56510dc9acee4897b6cbc2d4baaa3d38
              name: 'StackUnit-{#SNMPVALUE} Temperature sensor status'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.15.1.11.{#SNMPVALUE}'
              key: 'rlPhdUnitEnvParamTempSensorStatus[{#SNMPVALUE}]'
              history: 14d
              trends: 60d
              valuemap:
                name: 'ENTITY-SENSORS-MIB::EntitySensorStatus'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                - tag: component
                  value: temperature
              trigger_prototypes:
                - uuid: 2895ad241da54868b9a7f2af04a46781
                  expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamTempSensorStatus[{#SNMPVALUE}],#2)<>1'
                  name: 'Temperature status is not OK on {HOST.NAME} StackUnit-{#SNMPVALUE}'
                  priority: WARNING
                  tags:
                    - tag: scope
                      value: availability
            - uuid: 8974107967d54ad79e03d01635d369b0
              name: 'StackUnit-{#SNMPVALUE} Temperature sensor value'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.15.1.10.{#SNMPVALUE}'
              key: 'rlPhdUnitEnvParamTempSensorValue[{#SNMPVALUE}]'
              history: 14d
              trends: 60d
              units: C`
              tags:
                - tag: component
                  value: temperature
            - uuid: b98c4298473146dc838a8673db41e072
              name: 'StackUnit-{#SNMPVALUE} Temperature sensor Warning Threshold Value'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.15.1.12.{#SNMPVALUE}'
              key: 'rlPhdUnitEnvParamTempSensorWarningThresholdValue[{#SNMPVALUE}]'
              delay: 1h
              history: 2d
              trends: '0'
              units: C`
              preprocessing:
                - type: DISCARD_UNCHANGED
                  parameters:
                    - ''
              tags:
                - tag: component
                  value: temperature
            - uuid: ba3b28887e0c405ba12b5414746d78dc
              name: 'StackUnit-{#SNMPVALUE} FirmwareVersion'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.14.1.3.{#SNMPVALUE}'
              key: 'rlPhdUnitGenParamFirmwareVersion[{#SNMPVALUE}]'
              delay: 1h
              history: 14d
              value_type: CHAR
              trends: '0'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: component
                  value: system
            - uuid: 9cddd1914ee247c49b900e5284e3681b
              name: 'StackUnit-{#SNMPVALUE} HardwareVersion'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.14.1.4.{#SNMPVALUE}'
              key: 'rlPhdUnitGenParamHardwareVersion[{#SNMPVALUE}]'
              delay: 1h
              history: 14d
              value_type: CHAR
              trends: '0'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: component
                  value: system
            - uuid: cb0564acb08d46c5bf4ac733d2dca6e7
              name: 'StackUnit-{#SNMPVALUE} SerialNum'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.14.1.5.{#SNMPVALUE}'
              key: 'rlPhdUnitGenParamSerialNum[{#SNMPVALUE}]'
              delay: 1h
              history: 14d
              value_type: CHAR
              trends: '0'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: component
                  value: system
            - uuid: 056020856acc4416bf5a84e597b58424
              name: 'StackUnit-{#SNMPVALUE} SoftwareVersion'
              type: SNMP_AGENT
              snmp_oid: '.1.3.6.1.4.1.89.53.14.1.2.{#SNMPVALUE}'
              key: 'rlPhdUnitGenParamSoftwareVersion[{#SNMPVALUE}]'
              delay: 1h
              history: 14d
              value_type: CHAR
              trends: '0'
              preprocessing:
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              tags:
                - tag: component
                  value: system
          trigger_prototypes:
            - uuid: d7d359ce9c8049d3adb87e8c3efa1fda
              expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamTempSensorValue[{#SNMPVALUE}])>last(/Eltex MES by SNMP export/rlPhdUnitEnvParamTempSensorWarningThresholdValue[{#SNMPVALUE}])'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'last(/Eltex MES by SNMP export/rlPhdUnitEnvParamTempSensorValue[{#SNMPVALUE}])<last(/Eltex MES by SNMP export/rlPhdUnitEnvParamTempSensorWarningThresholdValue[{#SNMPVALUE}])-5'
              name: 'Check {HOST.NAME} StackUnit-{#SNMPVALUE} temperature'
              priority: HIGH
              tags:
                - tag: scope
                  value: availability
      tags:
        - tag: class
          value: network
        - tag: target
          value: eltex
        - tag: target
          value: eltex-mes
      macros:
        - macro: '{$CPU.MAX.USAGE}'
          value: '70'
        - macro: '{$ICMP_LOSS_WARN}'
          value: '20'
          description: 'Warning threshold of ICMP packet loss in %.'
        - macro: '{$ICMP_RESPONSE_TIME_WARN}'
          value: '0.15'
          description: 'Warning threshold of the average ICMP response time in seconds.'
        - macro: '{$IF.ERRORS.WARN}'
          value: '10'
        - macro: '{$IF.UTIL.MAX}'
          value: '90'
        - macro: '{$IFCONTROL}'
          value: '1'
        - macro: '{$MEM.MAX.USAGE}'
          value: '70'
        - macro: '{$NET.IF.IFADMINSTATUS.MATCHES}'
          value: '^.*'
        - macro: '{$NET.IF.IFADMINSTATUS.NOT_MATCHES}'
          value: ^2$
          description: 'Ignore down(2) administrative status'
        - macro: '{$NET.IF.IFALIAS.MATCHES}'
          value: '.*'
        - macro: '{$NET.IF.IFALIAS.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$NET.IF.IFDESCR.MATCHES}'
          value: '.*'
        - macro: '{$NET.IF.IFDESCR.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$NET.IF.IFNAME.MATCHES}'
          value: '^.*$'
        - macro: '{$NET.IF.IFNAME.NOT_MATCHES}'
          value: CHANGE_IF_NEEDED
        - macro: '{$NET.IF.IFOPERSTATUS.MATCHES}'
          value: '^.*$'
        - macro: '{$NET.IF.IFOPERSTATUS.NOT_MATCHES}'
          value: ^6$
          description: 'Ignore notPresent(6)'
        - macro: '{$SFP.INOUTPOW.RATIO}'
          value: '2.5'
          description: 'Во сколько раз различаются InPow и OutPow. Увеличить коэффициент - загрубить триггер.'
        - macro: '{$SFP.MAX.TEMPERATURE}'
          value: '60'
          description: 'Макс. температура модуля SFP'
        - macro: '{$SNMP.TIMEOUT}'
          value: 5m
          description: 'Time interval for the SNMP availability trigger.'
      valuemaps:
        - uuid: 0787434a84b347dc8bfbef357d7f5315
          name: 'ENTITY-SENSORS-MIB::EntitySensorStatus'
          mappings:
            - value: '1'
              newvalue: ok
            - value: '2'
              newvalue: unavailable
            - value: '3'
              newvalue: nonoperational
        - uuid: 05a5d3a19adb435994088ebf308ca846
          name: 'IF-MIB::ifOperStatus'
          mappings:
            - value: '1'
              newvalue: up
            - value: '2'
              newvalue: down
            - value: '3'
              newvalue: testing
            - value: '4'
              newvalue: unknown
            - value: '5'
              newvalue: dormant
            - value: '6'
              newvalue: notPresent
            - value: '7'
              newvalue: lowerLayerDown
        - uuid: 18aec19465164521b2aeb3cfab5e8a12
          name: RlEnvMonState
          mappings:
            - value: '1'
              newvalue: normal
            - value: '2'
              newvalue: warning
            - value: '3'
              newvalue: critical
            - value: '4'
              newvalue: shutdown
            - value: '5'
              newvalue: notPresent
            - value: '6'
              newvalue: notFunctioning
            - value: '7'
              newvalue: readingFailed
            - value: '8'
              newvalue: notAvailable
            - value: '9'
              newvalue: backingUp
            - value: '10'
              newvalue: readingFailed
